<div class="purchase-wrap">
  <h2>Add Purchase</h2>

  <form [formGroup]="purchaseForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label>Customer ID</label>
      <input type="text" formControlName="customer_id" placeholder="Enter Customer ID" />
      <small class="error" *ngIf="purchaseForm.get('customer_id')?.touched && purchaseForm.get('customer_id')?.invalid">
        Customer ID is required.
      </small>
    </div>

    <div formArrayName="items" class="item-list">
      <h3>Items</h3>
      <div *ngFor="let item of items.controls; let i = index" [formGroupName]="i" class="item-row">
        <input type="text" placeholder="Item Name" formControlName="item_name" />
        <input type="number" placeholder="Price" formControlName="price" />
        <input type="number" placeholder="Quantity" formControlName="quantity" />
        <button type="button" class="remove-btn" (click)="removeItem(i)" *ngIf="items.length > 1">âœ•</button>

        <div class="validation">
          <small *ngIf="item.get('item_name')?.touched && item.get('item_name')?.invalid">Item name required</small>
          <small *ngIf="item.get('price')?.touched && item.get('price')?.invalid">Enter valid price</small>
          <small *ngIf="item.get('quantity')?.touched && item.get('quantity')?.invalid">Enter valid quantity</small>
        </div>
      </div>
      <button type="button" class="add-btn" (click)="addItem()">+ Add Item</button>
    </div>

    <button type="submit" [disabled]="loading" class="submit-btn">
      {{ loading ? 'Saving...' : 'Save Purchase' }}
    </button>

  
  </form>
</div>
